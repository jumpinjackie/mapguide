<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Fragment>
    <DirectoryRef Id="INSTALLLOCATION">
      <Directory Id="WEBEXTENSIONSLOCATION" Name="MapGuide Web">
        <Component Id="WebExtensionsComponent" Guid="AE77C8EB-284D-4410-903F-92AD516DEA93">
          <CreateFolder />
        </Component>
          <Directory Id="APACHELOCATION" Name="Apache2">
              
          </Directory>
          <Directory Id="PHPLOCATION" Name="Php">
              <Component Id="WebExtPhpComponent" Guid="88814E96-07DC-4fb7-A993-F31FC1E000CB" Feature="WebExtPhpFeature">
                  <CreateFolder />
                  <Environment Id="PhpEnvVar"
                               Action="set"
                               Name="PATH"
                               Part="last"
                               Permanent="no"
                               System="yes"
                               Value="[PHPLOCATION]" />
                  <RegistryKey Action="createAndRemoveOnUninstall"
                               Root="HKLM"
                               Key="Software\PHP\[PHP_VERSION]">
                      <RegistryValue Action="write"
                                 Name="IniFilePath"
                                 Type="string"
                                 Value="[PHPLOCATION]" />
                  </RegistryKey>
              </Component>
          </Directory>
          <Directory Id="WEBROOTLOCATION" Name="www">
              <Component Id="WebRootComponent" Guid="A84579E6-285D-4869-9F04-AA47FB1ACFD5" Feature="WebExtensionsFeature">
                  <CreateFolder />
                  <IniFile Id="INISETMAPAGENTRESOURCESPATH"
                           Action="addLine"
                           Directory="WEBROOTLOCATION"
                           Key="ResourcesPath"
                           Name="webconfig.ini"
                           Section="GeneralProperties"
                           Value="[WEBROOTLOCATION]mapagent\Resources" />
                  <IniFile Id="INISETWEBTEMPPATH"
                           Action="addLine"
                           Directory="WEBROOTLOCATION"
                           Key="TempPath"
                           Name="webconfig.ini"
                           Section="GeneralProperties"
                           Value="[TempFolder]" />
                  <IniFile Id="INISETSERVERIP"
                           Action="addLine"
                           Directory="WEBROOTLOCATION"
                           Key="IpAddress"
                           Name="webconfig.ini"
                           Section="SiteConnectionProperties"
                           Value="[MGSERVER_IP]" />
                  <IniFile Id="INISETTEMPLATEROOTPATH"
                           Action="addLine"
                           Directory="WEBROOTLOCATION"
                           Key="TemplateRootFolder"
                           Name="webconfig.ini"
                           Section="WebApplicationProperties"
                           Value="[dir_fusion_0]templates\mapguide" />
                  <IniFile Id="INISETWIDGETINFOPATH"
                           Action="addLine"
                           Directory="WEBROOTLOCATION"
                           Key="WidgetInfoFolder"
                           Name="webconfig.ini"
                           Section="WebApplicationProperties"
                           Value="[dir_fusion_0]widgets\widgetinfo" />
                  <IniFile Id="INISETCONTAINERINFOPATH"
                           Action="addLine"
                           Directory="WEBROOTLOCATION"
                           Key="ContainerInfoFolder"
                           Name="webconfig.ini"
                           Section="WebApplicationProperties"
                           Value="[dir_fusion_0]containerinfo" />
              </Component>
          </Directory>
          <Directory Id="TOMCATLOCATION" Name="Tomcat">
              
          </Directory>
      </Directory>
    </DirectoryRef>
    <Feature Id="WebExtensionsFeature" Title="MapGuide Web" Level="1" ConfigurableDirectory="WEBEXTENSIONSLOCATION" Description="MapGuide Web provides you with the components you need to server MapGuide resources over the internet." AllowAdvertise="no" TypicalDefault="install" InstallDefault="local" >
      <ComponentRef Id="WebExtensionsComponent"/>
      <Feature Id="WebExtApacheFeature" Title="Apache Web Server" Level="1" Description="A bundled version of Apache with MapGuide enabled, running on port 8008." AllowAdvertise="no" TypicalDefault="install" InstallDefault="local" >
          <Condition Level="0">MGWEB_CONFIG = "IIS"</Condition>
        <ComponentGroupRef Id="group_APACHEFILES"/>
      </Feature>
      <Feature Id="WebExtPhpFeature" Title="PHP Hypertext Processor" Level="1" Description="A bundled version of PHP with MapGuide enabled." Absent="disallow" AllowAdvertise="no" TypicalDefault="install" InstallDefault="local" >
        <ComponentGroupRef Id="group_PHPFILES"/>
      </Feature>
      <Feature Id="WebExtTomcatFeature" Title="Tomcat Java Webserver" Level="1" Description="A bundled version of Tomcat with MapGuide enabled." AllowAdvertise="no" TypicalDefault="install" InstallDefault="local" >
        <ComponentGroupRef Id="group_TOMCATFILES"/>
      </Feature>
      <Feature Id="WebExtMapViewerFeature" Title="Map Viewer files" Display="hidden" Level="1" Description="The support files for the map viewer, language independant." AllowAdvertise="no" TypicalDefault="install" InstallDefault="local" >
        <ComponentGroupRef Id="group_MAPVIEWERFILES"/>
      </Feature>
      <Feature Id="WebExtMapViewerPHPFeature" Title="PHP Map Viewer" Level="1" Description="The PHP version of the map viewer." AllowAdvertise="no" TypicalDefault="install" InstallDefault="local" >
        <ComponentGroupRef Id="group_MAPVIEWERPHPFILES"/>
      </Feature>
      <Feature Id="WebExtMapViewerJSPFeature" Title="JSP Map Viewer" Level="1" Description="The JSP version of the map viewer." AllowAdvertise="no" TypicalDefault="install" InstallDefault="local" >
        <ComponentGroupRef Id="group_MAPVIEWERJSPFILES"/>
      </Feature>
      <Feature Id="WebExtMapViewerASPXFeature" Title=".Net Map Viewer" Level="1" Description="The .Net version of the map viewer." AllowAdvertise="no" TypicalDefault="install" InstallDefault="local" >
          <Condition Level="0">MGWEB_CONFIG = "APACHE"</Condition>
        <ComponentGroupRef Id="group_MAPVIEWERASPXFILES"/>
      </Feature>
        <Feature Id="WebLocalizedFeature" Title="Localization Files" Display="hidden"  Level="1" Description="Localization files for the web tier" AllowAdvertise="no" TypicalDefault="install" InstallDefault="local">
            <ComponentGroupRef Id="group_MAPVIEWERLOCALIZEDFILES" />
        </Feature>
        <Feature Id="WebFusionFeature" Title="Fusion" Display="hidden"  Level="1" Description="Fusion is a web-mapping application framework, allowing non-spatial web developers to build rich mapping applications quickly and easily" AllowAdvertise="no" TypicalDefault="install" InstallDefault="local">
            <ComponentGroupRef Id="group_FUSIONFILES"/>
        </Feature>
        <Feature Id="WebMapAdminFeature" Title="MapGuide Site Administrator" Display="hidden" Level="1" Description="The MapGuide Site Administrator is a web-based administrative front-end for the MapGuide Server" AllowAdvertise="no" TypicalDefault="install" InstallDefault="local">
            <ComponentGroupRef Id="group_MAPVIEWERMAPADMINFILES" />
        </Feature>
        <Feature Id="WebMapAgentFeature" Title="Map Agent" Display="hidden"  Level="1" Description="The map agent allows client applications to communicate with MapGuide over HTTP" AllowAdvertise="no" TypicalDefault="install" InstallDefault="local">
            <ComponentGroupRef Id="group_MAPAGENTFILES" />
        </Feature>
        <Feature Id="WebSchemaReportFeature" Title="Schema Report" Display="hidden"  Level="1" Description="The schema report allows the user to describe and preview MapGuide feature sources" AllowAdvertise="no" TypicalDefault="install" InstallDefault="local">
            <ComponentGroupRef Id="group_MAPVIEWERSCHEMAREPORTFILES" />
        </Feature>
        <Feature Id="WebStdIconsFeature" Title="Standard Icons" Display="hidden"  Level="1" Description="Icons for the AJAX viewer" AllowAdvertise="no" TypicalDefault="install" InstallDefault="local">
            <ComponentGroupRef Id="group_MAPVIEWERSTDICONFILES" />
        </Feature>
        <ComponentGroupRef Id="group_WEBROOTFILES"/>
    </Feature>
  </Fragment>
</Wix>
