<?xml version='1.0' encoding='UTF-8'?>
<project>
  <actions/>
  <description></description>
  <logRotator class="hudson.tasks.LogRotator">
    <daysToKeep>-1</daysToKeep>
    <numToKeep>1</numToKeep>
    <artifactDaysToKeep>-1</artifactDaysToKeep>
    <artifactNumToKeep>-1</artifactNumToKeep>
  </logRotator>
  <keepDependencies>false</keepDependencies>
  <properties>
    <hudson.model.ParametersDefinitionProperty>
      <parameterDefinitions>
        <hudson.model.StringParameterDefinition>
          <name>FDO_BUILD_SRC</name>
          <description>FDO Source directory</description>
          <defaultValue>C:\working\sources\fdo-3.9</defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.StringParameterDefinition>
          <name>FDO_VERSION</name>
          <description>FDO Version Number (major.minor.rev)</description>
          <defaultValue>3.9.0</defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.BooleanParameterDefinition>
          <name>CLEAR_WORKING_AREA</name>
          <description></description>
          <defaultValue>true</defaultValue>
        </hudson.model.BooleanParameterDefinition>
        <hudson.model.StringParameterDefinition>
          <name>FDO_STAMP_FILE_SOURCE</name>
          <description></description>
          <defaultValue>C:\working\sources\fdo_39_revision.txt</defaultValue>
        </hudson.model.StringParameterDefinition>
        <hudson.model.BooleanParameterDefinition>
          <name>FDO_RUN_UNIT_TESTS</name>
          <description></description>
          <defaultValue>true</defaultValue>
        </hudson.model.BooleanParameterDefinition>
      </parameterDefinitions>
    </hudson.model.ParametersDefinitionProperty>
  </properties>
  <scm class="hudson.scm.NullSCM"/>
  <canRoam>true</canRoam>
  <disabled>false</disabled>
  <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
  <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
  <jdk>(Default)</jdk>
  <triggers/>
  <concurrentBuild>false</concurrentBuild>
  <builders>
    <hudson.tasks.BatchFile>
      <command>@echo off
SET FDOMYSQL=%MG_LIB_ROOT%\fdo_rdbms_thirdparty\mysql
SET FDOORACLE=%MG_LIB_ROOT%\fdo_rdbms_thirdparty\oracle\instantclient\11.2\sdk
SET FDOPOSTGRESQL=%MG_LIB_ROOT%\fdo_rdbms_thirdparty\pgsql
SET FDO_BUILD_OUTPUT=%MG_BUILD_ARTIFACT_PATH%\fdo\%FDO_VERSION%\x86
SET FDO_BIN_EXTRAS=%MG_LIB_ROOT%\fdo_extras\%FDO_VERSION%\x86
SET REVNUM_FILE=%MG_TOOL_PATH%\revnum.pl
SET FDO_STAMP_FILE=%MG_BUILD_ARTIFACT_PATH%\last_fdo_%FDO_VERSION%_revision_x86.txt
SET FDO_WORKING_AREA=%MG_BUILD_AREA%\FDO\%FDO_VERSION%\x86

echo ============ Env Vars for FDO Build =====================
echo FDOMYSQL           = %FDOMYSQL%
echo FDOORACLE          = %FDOORACLE%
echo FDOPOSTGRESQL      = %FDOPOSTGRESQL%
echo FDO_BUILD_OUTPUT   = %FDO_BUILD_OUTPUT%
echo FDO_BIN_EXTRAS     = %FDO_BIN_EXTRAS%
echo REVNUM_FILE        = %REVNUM_FILE%
echo FDO_STAMP_FILE     = %FDO_STAMP_FILE%
echo FDO_WORKING_AREA   = %FDO_WORKING_AREA%
echo =========================================================

REM Pre-build checks, nuke artifact dir and working area
echo [prepare]: Clean out build area and build artifacts
if exist %FDO_BUILD_OUTPUT% rd /S /Q %FDO_BUILD_OUTPUT%
if &quot;%CLEAR_WORKING_AREA%&quot;==&quot;false&quot; (
    echo [prepare]: Skip cleaning build area
    goto build_fdo
)
if exist %FDO_WORKING_AREA% rd /S /Q %FDO_WORKING_AREA%
if not exist %FDO_WORKING_AREA% mkdir %FDO_WORKING_AREA%

REM Need to supply --force otherwise it won&apos;t export into the dir we made
echo [prepare]: Exporting SVN working copy to build area
SET BUILD_ACTION=Exporting SVN working copy to build area
svn export %FDO_BUILD_SRC% %FDO_WORKING_AREA% --force -q
if &quot;%errorlevel%&quot;==&quot;1&quot; goto error

REM Copy non-UAC UpdateVersion
echo [prepare]: Copy non UAC-gimped UpdateVersion
SET BUILD_ACTION=Copy non UAC-gimped UpdateVersion
copy /Y %MG_TOOL_PATH%\UpdateVersion.exe %FDO_WORKING_AREA%\Thirdparty\util\UpdateVersion\bin
if &quot;%errorlevel%&quot;==&quot;1&quot; goto error

:build_fdo
echo [prepare]: Noting SVN revision
set /p REVISION= &lt; &quot;%FDO_STAMP_FILE_SOURCE%&quot;
copy /Y &quot;%FDO_STAMP_FILE_SOURCE%&quot; &quot;%FDO_STAMP_FILE%&quot;

pushd %FDO_WORKING_AREA%
echo [build]: Set env vars
call setenvironment.bat x86

echo [build]: build thirdparty
SET BUILD_ACTION=Build FDO Thirdparty
call build_thirdparty.bat -p=Win32 -a=buildinstall -o=%FDO_BUILD_OUTPUT%
if &quot;%errorlevel%&quot;==&quot;1&quot; goto error

echo [build]: build core and providers
SET BUILD_ACTION=Build FDO core/providers
call build.bat -p=Win32 -a=buildinstall -o=%FDO_BUILD_OUTPUT%
if &quot;%errorlevel%&quot;==&quot;1&quot; goto error

if not exist %FDO_BIN_EXTRAS% goto pack
echo [build]: Overlaying FDO extras to build artifacts
pushd %FDO_BIN_EXTRAS%
copy /Y *.* %FDO_BUILD_OUTPUT%\Fdo\Bin
popd

:pack
echo [build]: Pack files
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=fdo -b=%REVISION% -r=%FDO_VERSION%
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=shp -b=%REVISION% -r=%FDO_VERSION%
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=sdf -b=%REVISION% -r=%FDO_VERSION%
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=wfs -b=%REVISION% -r=%FDO_VERSION%
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=wms -b=%REVISION% -r=%FDO_VERSION%
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=rdbms -b=%REVISION% -r=%FDO_VERSION%
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=mysql -b=%REVISION% -r=%FDO_VERSION%
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=odbc -b=%REVISION% -r=%FDO_VERSION%
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=sqlspatial -b=%REVISION% -r=%FDO_VERSION%
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=gdal -b=%REVISION% -r=%FDO_VERSION%
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=kingoracle -b=%REVISION% -r=%FDO_VERSION%
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=ogr -b=%REVISION% -r=%FDO_VERSION%
rem call createtarzipbinfiles.bat -i=%FDO_BUILD_OUTPUT%\Fdo -o=%FDO_BUILD_OUTPUT%\dist -w=sqlite -b=%REVISION% -r=%FDO_VERSION%
popd

if &quot;%FDO_RUN_UNIT_TESTS%&quot;==&quot;false&quot; goto end
:fdo_unit_tests
pushd %FDO_WORKING_AREA%\Fdo\Unmanaged\Bin\Win32\Release
UnitTest.exe -NoWAIT &gt; %FDO_BUILD_OUTPUT%\fdocore_unittest.log
popd
pushd %FDO_WORKING_AREA%\Providers\SHP\Src\UnitTest
..\..\Bin\Win32\Release\UnitTest.exe -NoWAIT &gt; %FDO_BUILD_OUTPUT%\shp_unittest.log
popd
pushd %FDO_WORKING_AREA%\Providers\SDF\Src\UnitTest
..\..\Bin\Win32\Release\UnitTest.exe -NoWAIT &gt; %FDO_BUILD_OUTPUT%\sdf_unittest.log
popd
pushd %FDO_WORKING_AREA%\Providers\SQLite\Src\UnitTest
..\..\Bin\Win32\Release\UnitTest.exe -NoWAIT &gt; %FDO_BUILD_OUTPUT%\sqlite_unittest.log
popd
pushd %FDO_WORKING_AREA%\Providers\GDAL\Src\UnitTest
..\..\Bin\Win32\Release\UnitTest.exe -NoWAIT &gt; %FDO_BUILD_OUTPUT%\gdal_unittest.log
popd
pushd %FDO_WORKING_AREA%\Providers\WMS\Src\UnitTest
..\..\Bin\Win32\Release\UnitTest.exe -NoWAIT &gt; %FDO_BUILD_OUTPUT%\wms_unittest.log
popd
goto end

:error
echo An error occurred while building FDO: %BUILD_ACTION%
exit /b 1
:end
exit /b 0</command>
    </hudson.tasks.BatchFile>
  </builders>
  <publishers>
    <hudson.plugins.textfinder.TextFinderPublisher plugin="text-finder@1.10">
      <regexp>!!!FAILURES!!!</regexp>
      <succeedIfFound>false</succeedIfFound>
      <unstableIfFound>true</unstableIfFound>
      <alsoCheckConsoleOutput>true</alsoCheckConsoleOutput>
    </hudson.plugins.textfinder.TextFinderPublisher>
    <hudson.tasks.BuildTrigger>
      <childProjects>MapGuide Open Source 2.6 x86</childProjects>
      <threshold>
        <name>UNSTABLE</name>
        <ordinal>1</ordinal>
        <color>YELLOW</color>
        <completeBuild>true</completeBuild>
      </threshold>
    </hudson.tasks.BuildTrigger>
  </publishers>
  <buildWrappers/>
</project>