#!/bin/sh -
#	$Id: s_config,v 1.6 2006/10/30 22:31:44 gmf Exp $
#
# Build the autoconfiguration files.

trap 'rm -f aclocal.m4 ; exit 0' 0 1 2 3 13 15

. ./RELEASE

echo "Building aclocal.m4"
cat aclocal/*.ac aclocal_java/*.ac | sed -f lib_paths.sed > aclocal.m4

echo "Running autoheader to build config.hin"
rm -f config.hin
autoheader
chmod 444 config.hin

echo "Running autoconf to build configure"
rm -f configure
autoconf

echo "Performing post-edits"
# Edit version information we couldn't pre-compute.
sed -e "s/__EDIT_DBXML_VERSION_MAJOR__/$DBXML_VERSION_MAJOR/g" \
    -e "s/__EDIT_DBXML_VERSION_MINOR__/$DBXML_VERSION_MINOR/g" \
    -e "s/__EDIT_DBXML_VERSION_PATCH__/$DBXML_VERSION_PATCH/g" \
    -e "s/__EDIT_DBXML_VERSION_STRING__/$DBXML_VERSION_STRING/g" \
    -e "s/__EDIT_DBXML_VERSION__/$DBXML_VERSION/g" configure > configure.version
mv configure.version configure

rm -rf autom4te.cache
chmod 555 configure

chmod 555 config.guess config.sub install-sh
