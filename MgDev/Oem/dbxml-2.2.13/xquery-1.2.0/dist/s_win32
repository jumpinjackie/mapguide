#!/bin/sh -
#	$Id: s_win32,v 1.2 2004/08/19 14:00:12 jsnelson Exp $
#
# Build Windows/32 include files.

msgc="/* DO NOT EDIT: automatically built by dist/s_win32. */"
msgw="; DO NOT EDIT: automatically built by dist/s_win32."

. RELEASE

s=/tmp/__db_a$$
t=/tmp/__db_b$$
rm -f $s $t

trap 'rm -f $s $t ; exit 1' 1 2 3 13 15

f=../build_win32/xquery_config.h
(echo "$msgc" && sed "s/__EDIT_XQUERY_VERSION__/$XQUERY_VERSION/" win_config.in) > $t
cmp $t $f > /dev/null 2>&1 ||
    (echo "Building $f" && rm -f $f && cp $t $f && chmod 444 $f)

# f=../build_win32/libdb.rc
# cat <<ENDOFSEDTEXT > $s
# s/%MAJOR%/$XQUERY_VERSION_MAJOR/
# s/%MINOR%/$XQUERY_VERSION_MINOR/
# s/%PATCH%/$XQUERY_VERSION_PATCH/
# ENDOFSEDTEXT
# sed -f $s ../build_win32/libdbrc.src > $t
# cmp $t $f > /dev/null 2>&1 ||
#     (echo "Building $f" && rm -f $f && cp $t $f && chmod 444 $f)
# 
# f=../build_win32/libdb.def
# (echo $msgw &&
#  echo &&
#  echo \
#  "DESCRIPTION	'Berkeley XQuery $XQUERY_VERSION_MAJOR.$XQUERY_VERSION_MINOR Library'" &&
#  echo &&
#  echo EXPORTS;
# a=1
# for i in `sed -e '/^$/d' -e '/^#/d' win_exports.in`; do
# 	echo "	$i	@$a"
# 	a=`expr $a + 1`
# done) > $t
# cmp $t $f > /dev/null 2>&1 ||
#     (echo "Building $f" && rm -f $f && cp $t $f && chmod 444 $f)

rm -f $s $t
